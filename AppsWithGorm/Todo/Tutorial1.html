<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="2 - NSWindowController and Design Pattern MVC" href="Tutorial2.html" /><link rel="prev" title="Todo.app" href="index.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>1 - Programming under GNUstep - GNUstep Tutorials 2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">GNUstep Tutorials 2024 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">GNUstep Tutorials 2024 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ObjectiveCIntro/index.html">Introduction to Objective-C</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Building Apps with GORM</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Building Apps with GORM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1_Intro/index.html">1 - Introduction to GNUstep Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../2_Convertor/index.html">2 - Convertor</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 2 - Convertor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.1.html">2.1 - Designing the UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.2.html">2.2 - Outlets and Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2_Convertor/2.3.html">2.3 - Adding the Code</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../3_TimeMachine/index.html">3 - TimeMachine - a single window application</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 3 - TimeMachine - a single window application</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../3_TimeMachine/3.1.html">3.1 - A Basic Clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3_TimeMachine/3.2.html">3.2 - Analog Clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3_TimeMachine/3.3.html">3.3 - New Time Zone Dialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3_TimeMachine/3.4.html">3.4 - Multiple Clocks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../4_Money/index.html">4 - Money</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 4 - Money</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.1.html">4.1 - The Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.2.html">4.2 - Document Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.3.html">4.3 - Load and Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="../4_Money/4.4.html">4.4 - Drag and Drop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../5_Overview/index.html">5 - Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_LunarCalendar/index.html">6 - LunarCalendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7_NSLookupService/index.html">7 - NSLookupService</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Todo.app</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Todo.app</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">1 - Programming under GNUstep</a></li>
<li class="toctree-l3"><a class="reference internal" href="Tutorial2.html">2 - NSWindowController and Design Pattern MVC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../HelpfulWebsites.html">Helpful Websites</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppsWithCodeOnly/index.html">Building Apps from Code Only</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Building Apps from Code Only</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/index.html">First Steps in GNUstep GUI Programming</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of First Steps in GNUstep GUI Programming</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/1_SharedApplication.html">1 - The shared application object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/2_AppIcon.html">2 - Setting your application’s icon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/3_Menus.html">3 - Menus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/4_PointsSizesRectangles.html">4 - Points, Sizes and Rectangles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/5_Windows.html">5 - Adding a Window to your Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AppsWithCodeOnly/GettingStarted/6_Buttons.html">6 - Adding a Button in the Window</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../AppsWithRenaissance/index.html">Building Apps with Renaissance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CommandLineTools/index.html">Command-Line Tools</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="programming-under-gnustep">
<h1>1 - Programming under GNUstep<a class="headerlink" href="#programming-under-gnustep" title="Permalink to this heading">#</a></h1>
<p>This article was originally published in Linux Magazine France n°49, April 2003</p>
<p><strong>Authors:</strong> Nicolas Roard and Fabien Vallon<br />
<strong>Translation:</strong> Gerold Rupprecht and Nicolas Roard</p>
<p>This section is currently <strong>not</strong> under an open-source license.</p>
<p>Cleaned up by Ethan C</p>
<blockquote>
<div><p>This article needs to be cleaned up.
Converted from https://web.archive.org/web/20190926105521if_/http://www.roard.com/docs/lmf2.article/en.html</p>
<ul class="simple">
<li><p>[X] Fix code blocks</p></li>
<li><p>[ ] Fix spelling</p></li>
<li><p>[ ] Turn symbol and file names into <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">font</span></code></p></li>
<li><p>[ ] Download pictures into this directory</p></li>
<li><p>[ ] Add captions to pictures</p></li>
</ul>
</div></blockquote>
<p><em>Following the GNUstep project presentation <a class="reference external" href="https://web.archive.org/web/20190926105521/http://www.roard.com/docs/lmf1.article/">in issue number 47</a>, we will start a small application project that we will evolve and extend throughout the year.</em></p>
<section id="application-description">
<h2>Application description<a class="headerlink" href="#application-description" title="Permalink to this heading">#</a></h2>
<p>This month we are going to start with something simple. The objective of the program that we are going to make is to note and manage tasks to be done; the application name will be “Todo.app”.</p>
<p>The interface for the time being will be very simple, displaying the task list in the upper part and the task contents (description, date, etc.) in the lower part. It will of course be possible to add or delete a task, and even to save them all into a file.</p>
<p>This allows us to present the RAD (Rapid Application Development)<a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> tool supplied with GNUstep, Gorm, and to introduce some of the currently used Design Patterns<a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> in a GNUstep application.</p>
<p>You will notice over the course of these articles that the GNUstep framework itself makes heavy use of a number of known patterns.</p>
</section>
<section id="model-view-controller">
<h2>Model-View-Controller<a class="headerlink" href="#model-view-controller" title="Permalink to this heading">#</a></h2>
<p>Lets start with the very classic Model-View-Controller, which we can see in the following figure.</p>
<p>This pattern consists of separating the application into three parts.</p>
<ul class="simple">
<li><p>The model represents the business logic, namely the part of independent code from the graphic presentation or the interaction with the user.</p></li>
<li><p>The view is responsible for representing the model to the user.</p></li>
<li><p>The controller creates the link between the model and the view.</p></li>
</ul>
<p>This separation into three parts allows a cleaner conception: nothing stops you from using your model elsewhere (in a GNUstep web application for example), or to completely change your view while being sure to not affect the rest of your application.</p>
<p>In our case the graphic interface with which the user will interact with will be the View part. This graphic interface will be created with Gorm.</p>
<figure class="align-default" id="id9">
<img alt="../../_images/fig1.png" src="../../_images/fig1.png" />
<figcaption>
<p><span class="caption-text">Figure 1 - The Model-View-Controller Pattern</span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="delegation">
<h2>Delegation<a class="headerlink" href="#delegation" title="Permalink to this heading">#</a></h2>
<p>This pattern consists of sending certain work to a helper object called the delegate. The classic approach in object programming to improve or specialise an object is to sub-class it. The delegate consists not of modifying the object, but simply asking certain information or certain actions from the helper object. This pattern often helps to eliminate the necessity for a sub-class and thus simplifies the program.</p>
<p>To return to the analogy given by Aaron Hillegass<a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>, the sub-class falls back on the “Robocop” approach: to improve the policeman, we employ dozens of surgeons, and you must know perfectly how the human body functions. It is a powerful tool, but can be complex to manipulate.</p>
<p>Delegation returns to the “Knight Rider” approach: to improve Michael, we simply use a tool created for him, the car Kitt, which has all the indespensible gadgets required for the difficult (!) life of a policeman on roller skates.</p>
<p>For example, when a NSTableView widget (which displays a table or a list) needs to display itself, instead of subclassing it so that it responds to our needs, we can supply it with a delegate object.</p>
<p>When the NSTableView wants to draw itself, it will simply ask its delegate something like “How many lines do I have?” or “What should be displayed in the first column on the third line?”.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h2>
<p>Lets see if we can apply these patterns to our program.</p>
<section id="the-model">
<h3>The model<a class="headerlink" href="#the-model" title="Permalink to this heading">#</a></h3>
<p>Our model will be the task to be done, that is an object containing all related information for a given task. We will call this object class <code class="docutils literal notranslate"><span class="pre">Todo</span></code>. A <code class="docutils literal notranslate"><span class="pre">Todo</span></code> object contains for the moment three data members: a string of characters containing the task description, a character string containing an eventually more detailed note, and finally an integer containing the task progression indicator (maximum 100).</p>
<p>Each object could eventually contain subtasks, that is, other objects of the <code class="docutils literal notranslate"><span class="pre">Todo</span></code> class.</p>
<p>To simplify things we will allow having several application level tasks; we will thus simply have a table containing one or more <code class="docutils literal notranslate"><span class="pre">Todo</span></code> objects at the controller level.</p>
<p>Here is the interface of our model (placed in a <code class="docutils literal notranslate"><span class="pre">Todo.h</span></code> file):</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef __TODO_H__</span>
<span class="cp">#define __TODO_H__</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Foundation/Foundation.h&gt;</span>

<span class="k">@interface</span> <span class="nc">Todo</span> : <span class="bp">NSObject</span>
<span class="p">{</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">_note</span><span class="p">;</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">_description</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_progress</span><span class="p">;</span>
<span class="w">  </span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">_children</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">_parent</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Constructor</span>
<span class="p">-(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">initWithDescription:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nv">description</span><span class="w"> </span><span class="nf">andNote:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nv">note</span><span class="p">;</span>
<span class="c1">// modifiers</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setDescription:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">description</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setNote:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">note</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setProgress:</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="nv">progress</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setChildren:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">children</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addChild:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">child</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setParent:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">parent</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">removeChild:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">child</span><span class="p">;</span>
<span class="c1">// accessors</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nf">desc</span><span class="p">;</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nf">note</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">int</span><span class="p">)</span>  <span class="nf">progress</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">parent</span><span class="p">;</span>
<span class="p">-(</span><span class="bp">NSArray</span><span class="o">*</span><span class="p">)</span> <span class="nf">children</span><span class="p">;</span>
<span class="k">@end</span>

<span class="cp">#endif</span>
</pre></div>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">Todo</span></code> object could eventually contain subtasks (stored in the <code class="docutils literal notranslate"><span class="pre">_children</span></code> table); we can access the parent task if it exists by sending the parent message:</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">id</span><span class="w"> </span><span class="n">ParentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">myTask</span><span class="w"> </span><span class="n">parent</span><span class="p">];</span>
</pre></div>
</div>
<p>Here is the code for our model (placed in the Todo.m file) :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Todo.h&quot;</span>

<span class="k">@implementation</span> <span class="nc">Todo</span>

<span class="cm">/* Constructors */</span>

<span class="p">-(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_note</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span>
<span class="w">  </span><span class="n">_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">initWithDescription:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nv">description</span><span class="w"> </span><span class="nf">andNote:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nv">note</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithString</span><span class="o">:</span><span class="w"> </span><span class="n">description</span><span class="p">];</span>
<span class="w">  </span><span class="n">_note</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithString</span><span class="o">:</span><span class="w"> </span><span class="n">note</span><span class="p">];</span>
<span class="w">  </span><span class="n">_children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span>
<span class="w">  </span><span class="n">_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Destructor */</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RELEASE</span><span class="p">(</span><span class="n">_children</span><span class="p">);</span>
<span class="w">  </span><span class="n">RELEASE</span><span class="p">(</span><span class="n">_note</span><span class="p">);</span>
<span class="w">  </span><span class="n">RELEASE</span><span class="p">(</span><span class="n">_description</span><span class="p">);</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>

<span class="cm">/* Accessors */</span>

<span class="p">-(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nf">desc</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">_description</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nf">note</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">_note</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">-(</span><span class="kt">int</span><span class="p">)</span> <span class="nf">progress</span><span class="p">;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">_progress</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">_children</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">_parent</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="cm">/* Modifiers */</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">setDescription</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">_description</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="w">  </span><span class="n">_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithString</span><span class="o">:</span><span class="w"> </span><span class="n">description</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">setNote</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">_note</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="w">  </span><span class="n">_note</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithString</span><span class="o">:</span><span class="w"> </span><span class="n">note</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">setProgress</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">progress</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">progress</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">))</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">  	</span><span class="n">_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">progress</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">addChild</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">_children</span><span class="w"> </span><span class="n">addObject</span><span class="o">:</span><span class="w"> </span><span class="n">child</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">setParent</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ASSIGN</span><span class="w"> </span><span class="p">(</span><span class="n">_parent</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">setChildren</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ASSIGN</span><span class="w"> </span><span class="p">(</span><span class="n">_children</span><span class="p">,</span><span class="w"> </span><span class="n">children</span><span class="p">);</span>
<span class="p">}</span>

<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">removeChild</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">_children</span><span class="w"> </span><span class="n">removeObject</span><span class="o">:</span><span class="w"> </span><span class="n">child</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>
</div>
<section id="the-view">
<h4>The View<a class="headerlink" href="#the-view" title="Permalink to this heading">#</a></h4>
<p>Even it it is absolutely possible to manually develop the interface, a RAD tool exists as part of the GNUstep development platform, a clone of the OPENSTEP/MacOSX Interface Builder named Gorm<a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<p>Even if the version number is only 0.2.6, Gorm is already very usable (and used) for the development of graphical interfaces.</p>
<p>Gorm is part of the GNUstep project and is thus in the CVS.</p>
</section>
</section>
<section id="gorm-installation">
<h3>Gorm Installation<a class="headerlink" href="#gorm-installation" title="Permalink to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cvs<span class="w"> </span>-z3<span class="w"> </span>-d:pserver:anoncvs@subversions.gnu.org:2401/cvsroot/gnustep<span class="w"> </span>co<span class="w"> </span>Gorm
<span class="nb">cd</span><span class="w"> </span>Gorm
<span class="nb">cd</span><span class="w"> </span>GormLib<span class="p">;</span><span class="w"> </span>make<span class="p">;</span><span class="w"> </span>su<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;make install&quot;</span><span class="p">;</span><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>..
make
make<span class="w"> </span>install
</pre></div>
</div>
<p>You can download the tgz packages from the GNUstep project website (<a class="reference external" href="https://web.archive.orghttps://web.archive.org/web/20190926105521/http://www.gnustep.org/">http://www.gnustep.org</a>).</p>
</section>
</section>
<section id="creating-the-graphic-interfaces">
<h2>Creating the graphic interfaces<a class="headerlink" href="#creating-the-graphic-interfaces" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p><em>“For the novice or occasional user, the interface must be simple and easy to learn and remember. It should not need to be relearned after a long absence from the computer.”</em><br />
(NeXT Interface Guide)</p>
</div></blockquote>
<p>Launch Gorm:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>openapp<span class="w"> </span>Gorm.app
</pre></div>
</div>
<p>Create a new application: Document → New Application.</p>
<figure class="align-default" id="id10">
<img alt="../../_images/fig2.png" src="../../_images/fig2.png" />
<figcaption>
<p><span class="caption-text">Figure 2 - Creating an application</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In the “Tools” menu click on “Palettes” and “Inspector”.</p>
<p>The palettes window contains various needed objects that make up an interface (windows, buttons, textfields…).</p>
<figure class="align-default" id="id11">
<img alt="../../_images/fig3.png" src="../../_images/fig3.png" />
<figcaption>
<p><span class="caption-text">Figure 3 - the Palettes window</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In this window (see figure), by clicking on the different sections, we have in order from left to right:</p>
<ul class="simple">
<li><p>The Menus and menu items (for the application menu).</p></li>
<li><p>The windows and Panels</p></li>
<li><p>The controls (Buttons, Textfields, Sliders…)</p></li>
<li><p>The containers (TreeView and TextView)</p></li>
</ul>
<p>The Inspector window represents the different object views that we can manipulate; Figure 2 shows for example in the attribute inspector the window attributes (<code class="docutils literal notranslate"><span class="pre">NSWindow</span></code>) of our application.</p>
<p>The inspectors are often found in GNUstep, OpenStep, and Cocoa applications; they allow, for example, to display additional details on a document when needed, instead of uselessly encumbering the screen with this information when it is not necessary.</p>
<p>In Gorm’s inspector, we have the following views (by manipulating the drop down list):</p>
<ul class="simple">
<li><p>Attributes: allows defining the selected widget attributes</p></li>
<li><p>Connection: allows defining the connections between different objects (graphical or not)</p></li>
<li><p>Size: The initial size and resizing characteristics of an object</p></li>
<li><p>Help: The help.</p></li>
</ul>
<p>The interface of our Todo.app program will be made up of an NSOutlineView widget, displaying a task list in a tree like manner (because we will eventually have sub tasks), accompanied with several buttons (add a task (“+”), add a sub task (“&lt;”), delete a task (“-“)).</p>
<p>For the moment, the lower part of the Todo.app window will directly display the selected task contents. It will contain two NSTextFields (Description and Note) and a NSProgressView displaying the task progression. We will also add an “Update” button which will be used to update a task that we have modified.</p>
<p>We will change this next month to have an inspector (a separate window) on a task instead of including everything in the main window.</p>
<p>Go in the “Contents” section of the Palettes panel and put a NSOutlineView widget. When you place the objects in your window, you will see “magnets” lines (the red lines) which permits you to position correctly your objects according to the guideline (see figure).</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/Aimants.png" /></p>
<p>Double-click on the NSOutlineView, and a second time on the first column’s title (for editing it), and write “Description”. In the inspector, set the identifier <code class="docutils literal notranslate"><span class="pre">DESCRIPTIONTAG</span></code> to this column. Do the same thing for the second column, with “Status” as title and <code class="docutils literal notranslate"><span class="pre">STATUSTAG</span></code> as identifier.</p>
<p>After that, put a <code class="docutils literal notranslate"><span class="pre">NSTextField</span></code> (which will contain the description of a <code class="docutils literal notranslate"><span class="pre">Todo</span></code>), a <code class="docutils literal notranslate"><span class="pre">NSTextView</span></code> (which will contain the eventual details of this Todo), and an horizontal <code class="docutils literal notranslate"><span class="pre">NSSlider</span></code> for the progression.</p>
<p>Add the corresponding labels on the widgets’ sides. For editing a label, double-click simply on it and enter the text (“Description”, “Note”, “Progression”). Align the labels text to the right.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/Alignements.png" /></p>
<p>Let us pass to the menu; we add the “infos” item.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/Menus.png" /></p>
<p>Be careful : the order of the items is important; for example, putting the Preferences or the Information Panel in other place than the Infos submenu (which should be the first menu item) should be considered as an ergonomy fault (at least, a non-respect of the *step guideline).</p>
<p>The next figure shows the result that you should have for the graphical interface.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/Resultat.png" /></p>
</section>
<section id="connecting-the-view-and-the-controller">
<h2>Connecting the View and the Controller<a class="headerlink" href="#connecting-the-view-and-the-controller" title="Permalink to this heading">#</a></h2>
<p>We have now a View (our graphical interface), and a model (our Todo class). We miss a controller in order to make everything works.</p>
<p>What will be the controller actions ? We want to :</p>
<ul class="simple">
<li><p>view a task</p></li>
<li><p>add a task: <code class="docutils literal notranslate"><span class="pre">addTodo:</span></code></p></li>
<li><p>add a sub-task: <code class="docutils literal notranslate"><span class="pre">addSubTodo:</span></code></p></li>
<li><p>remove a task: <code class="docutils literal notranslate"><span class="pre">removeTodo:</span></code></p></li>
<li><p>update a task: <code class="docutils literal notranslate"><span class="pre">updateTodo</span></code></p></li>
</ul>
<p>Our controller will stock the task list in an array (<code class="docutils literal notranslate"><span class="pre">NSMutableArray</span></code>), the different actions will be directly linked to the buttons of our GUI. A click on a line in our task list will update the fields Note, Description, in order to view the contents of the selected task.</p>
<p>The controller will then have access to the fields Note and Description, and to the <code class="docutils literal notranslate"><span class="pre">NSOutlineView</span></code> listing the tasks, in order to update their state. The controller will then have “pointers” to theses widgets; thoses types of pointers are called “outlet” in the GNUstep terminology.</p>
<p>Let us create our controller. Under Gorm, in the Document panel, go in the Class Manager (following figure). We will subclass the <code class="docutils literal notranslate"><span class="pre">NSObject</span></code> class. Click on <code class="docutils literal notranslate"><span class="pre">NSObject</span></code> for selecting it if that’s not done.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/ClassManager.png" /></p>
<p>Under the “Classes” menu in Gorm (I advice you to detach it and put it near the Document panel), select “Create Subclass…”. A new class is created, called <code class="docutils literal notranslate"><span class="pre">NewClass</span></code>. Double-click on it to change its name in <code class="docutils literal notranslate"><span class="pre">TodoController</span></code>, then press enter to validate the name’s modification.</p>
<p>Click on the gray circle in the “Outlet” column (the one similar to an electric connector), and add an Outlet (Classes-&gt;Add Outlet/Action). Rename the outlet in “descriptionText”. Add then successively the outlets “noteTextView” and “todolistView”.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/ClassManager2.png" /></p>
<p>Deselect the class and click on the second gray point of TodoController representing the Actions, and add (again with Classes-&gt;Add Outlet/Action) the <code class="docutils literal notranslate"><span class="pre">addTodo:</span></code>, <code class="docutils literal notranslate"><span class="pre">addSubTodo:</span></code>, <code class="docutils literal notranslate"><span class="pre">removeTodo:</span></code> and <code class="docutils literal notranslate"><span class="pre">updateTodo:</span></code> actions.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/ClassManager3.png" /></p>
<p>Our controller is now ready to be used. Reselect the TodoController class in the Class Manager and click on the menu item Classes-&gt;instantiate. An instance of the TodoController class is now created in the Object section of the Document panel.</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/ClassManager4.png" /></p>
<p>It remains to connect our objects to this instance of the TodoController class.</p>
<p>Click on the TodoController instance while keeping pressed the control key &lt; Ctrl &gt; . The icon <img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/GormSourceTag.png" /> (as Source) appears, we drag the mouse until the NSOutlineView widget used to list our tasks. The icon <img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/GormTargetTag.png" /> (as Target) appears, we hold off the mouse. In the inspector, click on the “todolistView” outlet shown, then on “Connect”. The “todolistView” outlet of our controller is now connected with the NSOutlineView widget.</p>
<p>We do the same to connect the remaining outlets (Note and Description fields).</p>
<p>We do the inverse manipulation (press the control key, etc.), from the buttons (“+”,”&lt;”,”-” and “Update”) of our interface to the icon of the TodoController instance, in order to connect the Actions. In the inspector, click on “target” then choose the controller actions corresponding to the buttons.</p>
<p>Our controller is now connected with the actions and outlets which it needs.</p>
<p>Do the same manipulation between the outline view (our task list) and the controller, with the outline view as source and the controller as target. In the inspector, select the “dataSource” outlet of the outline view and click on “Connect”. Redo the same thing but this time connect the “delegate” outlet of the outline view to the controller. Thus, the outline view will ask the controller for the informations needed for its display.</p>
<p>Save the entire thing (Document-&gt;Save As…) under the name Todo.gorm .</p>
<section id="keyboard-navigation">
<h3>Keyboard Navigation<a class="headerlink" href="#keyboard-navigation" title="Permalink to this heading">#</a></h3>
<p>It is possible to connect the graphical objects between them, to set the orders of the objects when you will navigate from the keyboard (tab-key).</p>
<p>For this, select the Add button (“+”) and press simultaneously the key “control” (CTRL) and the mouse button.</p>
<p>You’ll have the icon <img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/GormSourceTag.png" /> which will appears on the add button. Hold on the mouse until the “add a subtask” button (“&lt;”). The icon <img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/GormTargetTag.png" /> will then appears. In the inspector, select nextKeyView and click on “connect”. Proceed in the same way but between the “add a subtask” (“&lt;”) button and the remove button (“-“), then between the remove button and the Description field, then between the Description field and the Note field, between the Note field and the Update button, and in the end, finish the cycle between the Update button and the add button (“+”). This will let the user cycle between all the widgets simply in using the “Tab” key.</p>
<p>So, now your interface will be more easily useable with the keyboard. Think to save your additions.</p>
</section>
<section id="code-of-the-controller">
<h3>Code of the Controller<a class="headerlink" href="#code-of-the-controller" title="Permalink to this heading">#</a></h3>
<p>We could finish our controller : in the Document panel, turn over in Class Manager, and select TodoController. Then click in the “Classes” menu in Gorm and select the item “Create Class Files”. Thus the skeleton of our controller will be automatically created by Gorm. We will add in the controller an array to contain the Todo list, which will call todoArray.</p>
<p>For the moment, our controller is very simple :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">TodoController</span> : <span class="bp">NSObject</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">descriptionText</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">noteTextView</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">todolistView</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">todoArray</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addSubTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">removeTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">updateTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>
<p>We will now add the “Data Source” methods used by the outline view for its display :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">child:</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="nv">index</span><span class="w"> </span><span class="nf">ofItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">numberOfChildrenOfItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">isItemExpandable:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">objectValueForTableColumn:</span><span class="w"> </span><span class="p">(</span><span class="n">NSTableColumn</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">tableColumn</span><span class="w"> </span><span class="nf">byItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
</pre></div>
</div>
<p>If our TodoController object responds to this messages, the outline view will use them for its display. The methods are quite simple in fact :</p>
<ul class="simple">
<li><p>The first must return the child placed at the index position of the item object.</p></li>
<li><p>The second must return the number of children that an item object will contains.</p></li>
<li><p>The third method must return YES (true) if the object passed in parameters item contains – or not – children.</p></li>
<li><p>The fourth method must return the cell value for a column, for the object given in parameter (so, for a line of the outline view). We could use “tags” (like thoses we entered earlier in Gorm) to do the selection</p></li>
</ul>
<p>We could note that the NSOutlineView widget inherit the NSTableView widget; its behavior is a bit more complex (as it uses a tree structure), but is based on the same principles. In fact, the original version of this article used a NSTableView, and didn’t used a tree structure for the Todo, but as we were shifted from one month, we profited to add some things ;-)</p>
<p>We also add to our controller a delegate function of the outline view, which will be called when the user will select an item (a Todo); so we will know when to update the Note and Description fields and the Progression according to the selected Todo.</p>
<p>The interface of our controller (which will be saved in a TodoController.h file) will then be :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef __TODOCONTROLLER_H__</span>
<span class="cp">#define __TODOCONTROLLER_H__</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;AppKit/AppKit.h&gt;</span>

<span class="k">@interface</span> <span class="nc">TodoController</span> : <span class="bp">NSObject</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">descriptionText</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">noteTextView</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">todolistView</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">sliderView</span><span class="p">;</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">progressView</span><span class="p">;</span>
<span class="w">  </span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">todoArray</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Actions</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addSubTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">removeTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">updateTodo:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setProgress:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>

<span class="c1">// NSOutlineView Data Source </span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">child:</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="nv">index</span><span class="w"> </span><span class="nf">ofItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">numberOfChildrenOfItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">isItemExpandable:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">objectValueForTableColumn:</span><span class="w"> </span><span class="p">(</span><span class="n">NSTableColumn</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">tableColumn</span><span class="w"> </span><span class="nf">byItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>

<span class="c1">// NSOutlineView delegate method</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">shouldSelectItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span><span class="p">;</span>

<span class="k">@end</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>We just need to add the corresponding code (in a TodoController.m file) :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Todo.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TodoController.h&quot;</span>

<span class="k">@implementation</span> <span class="nc">TodoController</span>

<span class="p">-(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">todoArray</span><span class="o">=</span><span class="p">[[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RELEASE</span><span class="p">(</span><span class="n">todoArray</span><span class="p">);</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Actions</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addTodo:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Todo</span><span class="w"> </span><span class="o">*</span><span class="n">aTodo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">Todo</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithDescription</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">descriptionText</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]</span>
<span class="w">	</span><span class="nl">andNote</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">noteTextView</span><span class="w"> </span><span class="n">string</span><span class="p">]];</span>
<span class="w">  </span><span class="p">[</span><span class="n">todoArray</span><span class="w"> </span><span class="n">addObject</span><span class="o">:</span><span class="w"> </span><span class="n">aTodo</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">aTodo</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">addSubTodo:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">selectedRow</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">     </span><span class="kt">id</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">itemAtRow</span><span class="o">:</span><span class="w"> </span><span class="n">row</span><span class="p">];</span>
<span class="w">     </span><span class="n">Todo</span><span class="w"> </span><span class="o">*</span><span class="n">aTodo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">Todo</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithDescription</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">descriptionText</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]</span>
<span class="w">                     </span><span class="nl">andNote</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">noteTextView</span><span class="w"> </span><span class="n">string</span><span class="p">]];</span>
<span class="w">     </span><span class="p">[</span><span class="n">aTodo</span><span class="w"> </span><span class="n">setParent</span><span class="o">:</span><span class="w"> </span><span class="n">item</span><span class="p">];</span>
<span class="w">     </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">addChild</span><span class="o">:</span><span class="w"> </span><span class="n">aTodo</span><span class="p">];</span>
<span class="w">     </span><span class="p">[</span><span class="n">aTodo</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="w">     </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">removeTodo:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">selectedRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">selectedRow</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">selectedRow</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">      </span><span class="kt">id</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">itemAtRow</span><span class="o">:</span><span class="w"> </span><span class="n">selectedRow</span><span class="p">];</span>
<span class="w">      </span><span class="kt">id</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">parent</span><span class="p">];</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="p">[</span><span class="n">parent</span><span class="w"> </span><span class="n">removeChild</span><span class="o">:</span><span class="w"> </span><span class="n">item</span><span class="p">];</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="p">[</span><span class="n">todoArray</span><span class="w"> </span><span class="n">removeObject</span><span class="o">:</span><span class="w"> </span><span class="n">item</span><span class="p">];</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">updateTodo:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">selectedRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">selectedRow</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">selectedRow</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">      </span><span class="n">Todo</span><span class="o">*</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">itemAtRow</span><span class="o">:</span><span class="w"> </span><span class="n">selectedRow</span><span class="p">];</span>
<span class="w">      </span><span class="p">[</span><span class="n">todo</span><span class="w"> </span><span class="n">setDescription</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">descriptionText</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">todo</span><span class="w"> </span><span class="n">setNote</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">noteTextView</span><span class="w"> </span><span class="n">string</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">todo</span><span class="w"> </span><span class="n">setProgress</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">progressView</span><span class="w"> </span><span class="n">doubleValue</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">todolistView</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">setProgress:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">[</span><span class="n">progressView</span><span class="w"> </span><span class="n">setDoubleValue</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">sender</span><span class="w"> </span><span class="n">intValue</span><span class="p">]];</span>
<span class="p">}</span>

<span class="cm">/* dataSource methods of the outline view */</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">child:</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="nv">index</span><span class="w"> </span><span class="nf">ofItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="c1">// racine</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">todoArray</span><span class="w"> </span><span class="n">objectAtIndex</span><span class="o">:</span><span class="w"> </span><span class="n">index</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="n">item</span><span class="w"> </span><span class="n">children</span><span class="p">]</span><span class="w"> </span><span class="n">objectAtIndex</span><span class="o">:</span><span class="w"> </span><span class="n">index</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">numberOfChildrenOfItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">todoArray</span><span class="w"> </span><span class="n">count</span><span class="p">];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="n">item</span><span class="w"> </span><span class="n">children</span><span class="p">]</span><span class="w"> </span><span class="n">count</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">isItemExpandable:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">([[</span><span class="n">item</span><span class="w"> </span><span class="n">children</span><span class="p">]</span><span class="w"> </span><span class="n">count</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">YES</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">objectValueForTableColumn:</span><span class="w"> </span><span class="p">(</span><span class="n">NSTableColumn</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">tableColumn</span><span class="w"> </span><span class="nf">byItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">[[</span><span class="n">tableColumn</span><span class="w"> </span><span class="n">identifier</span><span class="p">]</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;DESCRIPTIONTAG&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="n">todoArray</span><span class="w"> </span><span class="n">objectAtIndex</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">desc</span><span class="p">];</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">desc</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">[[</span><span class="n">tableColumn</span><span class="w"> </span><span class="n">identifier</span><span class="p">]</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;STATUSTAG&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%i/100&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">progress</span><span class="p">]];</span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithString</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;VOID&quot;</span><span class="p">];</span>
<span class="p">}</span>

<span class="cm">/* delegate methods of the outline view */</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">outlineView:</span><span class="w"> </span><span class="p">(</span><span class="n">NSOutlineView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">outlineView</span><span class="w"> </span><span class="nf">shouldSelectItem:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">item</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">      </span><span class="p">[</span><span class="n">descriptionText</span><span class="w"> </span><span class="n">setStringValue</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">desc</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">noteTextView</span><span class="w"> </span><span class="n">setString</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">note</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">progressView</span><span class="w"> </span><span class="n">setDoubleValue</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">progress</span><span class="p">]];</span>
<span class="w">      </span><span class="p">[</span><span class="n">sliderView</span><span class="w"> </span><span class="n">setIntValue</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">item</span><span class="w"> </span><span class="n">progress</span><span class="p">]];</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nb">YES</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>
</div>
</section>
</section>
<section id="the-main-function-of-our-programme">
<h2>The main function of our programme<a class="headerlink" href="#the-main-function-of-our-programme" title="Permalink to this heading">#</a></h2>
<p>The main of our program will simply call the NSApplication object and do some necessary initialisations :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w">  </span><span class="n">NSApplicationMain</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We will save it in a main.m file.</p>
</section>
<section id="the-makefiles">
<h2>The Makefiles<a class="headerlink" href="#the-makefiles" title="Permalink to this heading">#</a></h2>
<p>GNUstep provides its own system of makefiles for the different environments and systems, without using (directly) the complexes autoconf/automake. The makefile file must be called GNUmakefile.</p>
<p>gnustep-make is based on environments variables. Here is an exemple of a GNUmakefile for a “tool” – that is, a non-graphic GNUstep application. The different scripts are located in /System/Makefiles/</p>
<div class="highlight-makefile notranslate"><div class="highlight"><pre><span></span><span class="cp">include $(GNUSTEP_MAKEFILES)/common.make</span>
<span class="nv">TOOL_NAME</span><span class="o">=</span><span class="w"> </span>MyTool
<span class="nv">MyTool_OBJC_FILES</span><span class="o">=</span>main.m<span class="w"> </span>source.m
<span class="cp">include $(GNUSTEP_MAKEFILES)/tool.make</span>
</pre></div>
</div>
<p>Here is a small list of commonly used variables; We will prefix them with the <em>AppName</em> of the application :</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SUBPROJECTS</span></code></p></td>
<td><p>list of subprojects</p></td>
</tr>
<tr class="row-odd"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_OBJC_FILES</span></code></p></td>
<td><p>the Objective-C files</p></td>
</tr>
<tr class="row-even"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_C_FILES</span></code></p></td>
<td><p>the C files</p></td>
</tr>
<tr class="row-odd"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_HEADERS</span></code></p></td>
<td><p>the header files</p></td>
</tr>
<tr class="row-even"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_HEADER_FILES</span></code></p></td>
<td><p>public header files that should be installed ( for a framework)</p></td>
</tr>
<tr class="row-odd"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_RESOURCE_FILES</span></code></p></td>
<td><p>the resource files used by the program (for example images, Gorm interfaces)</p></td>
</tr>
<tr class="row-even"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_LOCALIZED_RESOURCE_FILES</span></code></p></td>
<td><p>resource files localized or translated into different languages</p></td>
</tr>
<tr class="row-odd"><td><p><em>AppName</em><code class="docutils literal notranslate"><span class="pre">_LANGUAGES</span></code></p></td>
<td><p>the languages supported by the app</p></td>
</tr>
</tbody>
</table>
</div>
<p>Here is the GNUmakefile of our Todo.app application :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">GNUSTEP_MAKEFILES</span><span class="p">)</span><span class="o">/</span><span class="n">common</span><span class="p">.</span><span class="n">make</span>
<span class="n">APP_NAME</span><span class="o">=</span><span class="n">Todo</span>
<span class="n">Todo_OBJC_FILES</span><span class="o">=</span><span class="n">main</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="n">TodoController</span><span class="p">.</span><span class="n">m</span><span class="w"> </span><span class="n">Todo</span><span class="p">.</span><span class="n">m</span>
<span class="n">Todo_RESOURCE_FILES</span><span class="o">=</span><span class="n">Todo</span><span class="p">.</span><span class="n">gorm</span>
<span class="n">Todo_MAIN_MODEL_FILE</span><span class="o">=</span><span class="n">Todo</span><span class="p">.</span><span class="n">gorm</span>
<span class="n">include</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">GNUSTEP_MAKEFILES</span><span class="p">)</span><span class="o">/</span><span class="n">application</span><span class="p">.</span><span class="n">make</span>
</pre></div>
</div>
<p>Let us compile it: make</p>
<p>Our application is called Todo.app. You could launch it by typing openapp Todo.app .</p>
<p>For the moment, you could add, modify and delete tasks… but we miss a small detail : the saving and reading of Todo files !</p>
</section>
<section id="archiving-an-object">
<h2>Archiving an object<a class="headerlink" href="#archiving-an-object" title="Permalink to this heading">#</a></h2>
<p>Archiving an object consists to transform it in a binary flow, architecture-independant, which preserves the identify and the relations between the objects and their values. It permits for example to send an object on the network or to save it on disk easily. Dearchiving an object, is to do the inverse operation, recreating an object from a binary flow. GNUstep permits to do it very easily.</p>
<p>In order to archive/dearchive an object, it just need to implement the NSCoding protocol, i.e, to implement the messages encodeWithCoder: (for archiving an object) and initWithCoder: (for dearchiving object).</p>
<p>Thoses two methods received in parameter an object of NSCoder type. The abstract class NSCoder is used to represent the binary flow, and to add to it the various data members of the object we want to archive. Indeed, the object is responsible of the encoding of its data members. It’s not forced to encode all its data members (some could be considered as non-important). But it’s required to keep the same encoding/decoding order of the datas, else you will have problems (see the following source). If you want to archive an object inheriting another object which responds also to the NSCoding protocol, you must add the line :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">encodingWithCoder</span><span class="o">:</span><span class="w"> </span><span class="n">coder</span><span class="p">];</span><span class="w"> </span>
</pre></div>
</div>
<p>in the beginning of the encoding method encodeWithCoder and</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">initWithCoder</span><span class="o">:</span><span class="w"> </span><span class="n">coder</span><span class="p">];</span><span class="w"> </span>
</pre></div>
</div>
<p>in the beginning of the deencoding method initWithCoder, so the data members of the father object will possibly be encoded if needed.</p>
<p>In our case, it’s not necessary, as Todo inherits directly from NSObject.</p>
<p>The objects of the GNUstep framework knows already how to encode or decode themselves, so it will thus be enough to use the encodeObject: method on the coder object given in parameters.</p>
<p>On the other hand, for C base types, you must use the methods <code class="docutils literal notranslate"><span class="pre">encodeValueOfObjcType:</span></code> and <code class="docutils literal notranslate"><span class="pre">decodeValueOfObjCType:</span></code> to whom you pass a macro <code class="docutils literal notranslate"><span class="pre">&#64;encode()</span></code> which defines the type and address of the variable we want to encode.</p>
<p>We thus add the functions encodeWithCoder: and initWithCoder: to our Todo object :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Encoding of the object */</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">encodeWithCoder:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSCoder</span><span class="o">*</span><span class="p">)</span> <span class="nv">coder</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">encodeObject</span><span class="o">:</span><span class="w"> </span><span class="n">_description</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">encodeObject</span><span class="o">:</span><span class="w"> </span><span class="n">_note</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">encodeValueOfObjCType</span><span class="o">:</span><span class="w"> </span><span class="k">@encode</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">at</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">_progress</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">encodeObject</span><span class="o">:</span><span class="w"> </span><span class="n">_parent</span><span class="p">];</span>
<span class="w">        </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">encodeObject</span><span class="o">:</span><span class="w"> </span><span class="n">_children</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nf">initWithCoder:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSCoder</span><span class="o">*</span><span class="p">)</span> <span class="nv">coder</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">])</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setDescription</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">decodeObject</span><span class="p">]];</span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setNote</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">decodeObject</span><span class="p">]];</span>
<span class="w">                </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">decodeValueOfObjCType</span><span class="o">:</span><span class="w"> </span><span class="k">@encode</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">at</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">_progress</span><span class="p">];</span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setParent</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">decodeObject</span><span class="p">]];</span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setChildren</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">coder</span><span class="w"> </span><span class="n">decodeObject</span><span class="p">]];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here we are ! our Todo objects now knows how to encode and decode themselves. We must now add to our controller the methods for reading and saving our Todo objects.</p>
</section>
<section id="modification-of-todocontroller">
<h2>Modification of TodoController<a class="headerlink" href="#modification-of-todocontroller" title="Permalink to this heading">#</a></h2>
<p>We add two methods prototypes in TodoController.h :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">saveFile:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="p">;</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">loadFile:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span> <span class="nv">sender</span><span class="p">;</span>
</pre></div>
</div>
<p>We add the body of theses methods in TodoController.m :</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span>-(void) saveFile: (id) sender {
  int ret;
  NSSavePanel* panel = [NSSavePanel savePanel];
  [panel setRequiredFileType: @`Todo`];
  [panel setDirectory: [[NSFileManager defaultManager] currentDirectoryPath]];

  ret = [panel runModal];
  if (ret == NSFileHandlingPanelOKButton)
  {
      [[NSArchiver archivedDataWithRootObject: todoArray] writeToFile: [panel filename] atomically: YES];
  }
}

-(void) loadFile: (id) sender {
  int ret;
  NSOpenPanel* panel = [NSOpenPanel openPanel];
  [panel setAllowsMultipleSelection: NO];
  [panel setDirectory: [[NSFileManager defaultManager] currentDirectoryPath]];

  ret = [panel runModalForTypes: [NSArray arrayWithObject: @`Todo`]];
  if (ret == NSOKButton)
  {
      id file = [NSUnarchiver unarchiveObjectWithData:
                [NSData dataWithContentsOfFile: [[panel filenames] objectAtIndex: 0]]];
      ASSIGN (todoArray, file);
      [todolistView reloadData];
  }
}
</pre></div>
</div>
<p>Some remarks : we choosed to use it the FileType <code class="docutils literal notranslate"><span class="pre">Todo</span></code>, that is, the “.todo” extension, for our saved files. The interesting point here is the use of the NSArchiver and NSUnarchiver classes, to whom we simply pass the array todoArray containing our Todo objects.</p>
</section>
<section id="modification-of-the-gorm-file">
<h2>Modification of the gorm file<a class="headerlink" href="#modification-of-the-gorm-file" title="Permalink to this heading">#</a></h2>
<p>Now that everything functions perfectly and that our application knows how to read and save Todo files, it could be interesting to let the user do it…</p>
<p>Launch Gorm on our Todo.gorm file : gopen Todo.gorm. Go in the Class Manager, and reload the TodoController Class («Classes-&gt;Load Class…» then read the TodoController.h file). Now, add two items in our application menu :</p>
<p><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/Menus2.png" /></p>
<p>Then, link the menu items “Open…” and “Save as…” to the TodoController controller, and connect them to the actions “loadFile:” and “saveFile:” now availables in the controller. Save the Gorm file, recompile the program (make), and voila !</p>
<p>You have now a functional Todo.app version – basic, but entirely functional. The next month we will modify the program to add an inspector… Until then, you are welcome to join the #gnustep channel on freenode irc network (irc.debian.org for example) !</p>
</section>
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><h3 class="rubric" id="contact-the-authors">Contact the authors</h3>
<p>Nicolas Roard, <a class="reference external" href="mailto:nicolas&#37;&#52;&#48;roard&#46;com">nicolas<span>&#64;</span>roard<span>&#46;</span>com</a><br />
Fabien Vallon, <a class="reference external" href="mailto:fabien&#37;&#52;&#48;tuxfamily&#46;org">fabien<span>&#64;</span>tuxfamily<span>&#46;</span>org</a></p>
</div></blockquote>
<blockquote>
<div><h3 class="rubric" id="contributors">Contributors</h3>
<p>Thanks to Vincent Ricard and Cyril Siman for reviewing this article !<br />
Big thanks to Gerold Rupprecht for the traduction and Matt Rice for reviewing this article in english :-)</p>
</div></blockquote>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The GNUstep wiki : <a class="reference external" href="https://web.archive.orghttps://web.archive.org/web/20190926105521/http://wiki.gnustep.org/">http://wiki.gnustep.org/</a></p></li>
<li><p>The tutorial page of the wiki : <a class="reference external" href="https://web.archive.orghttps://web.archive.org/web/20190926105521/http://wiki.gnustep.org/index.php/Tutorials">http://wiki.gnustep.org/index.php/Tutorials</a></p></li>
<li><p>A very good tutorial from Yen-Ju : <a class="reference external" href="https://web.archive.orghttps://web.archive.org/web/20190926105521/http://www.people.virginia.edu/%7Eyc2w/GNUstep/Tutorial/">http://www.people.virginia.edu/~yc2w/GNUstep/Tutorial/</a></p></li>
</ul>
<p><a class="reference external" href="https://web.archive.orghttps://web.archive.org/web/20190926105521/http://www.linuxmag-france.org/"><img alt="" src="https://web.archive.org/web/20190926105521im_/http://www.roard.com/docs/lmf2.article/LM49.jpg" /></a></p>
<section id="footnotes">
<h3>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this heading">#</a></h3>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Rapid Application Development</p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Design Patterns – Erich Gamma, Richard Helm, Ralph Johnson, and John Vlissides. ISBN 0201633612</p>
</aside>
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>«Cocoa Programming for Mac OS X» – Aaron Hillegass, ISBN 0-201-72683-1</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>as Graphic Object Relationship Modeler (or even GNUstep Object Relationship Modeler)</p>
</aside>
</aside>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Tutorial2.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">2 - NSWindowController and Design Pattern MVC</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Todo.app</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, GNUstep contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">1 - Programming under GNUstep</a><ul>
<li><a class="reference internal" href="#application-description">Application description</a></li>
<li><a class="reference internal" href="#model-view-controller">Model-View-Controller</a></li>
<li><a class="reference internal" href="#delegation">Delegation</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a><ul>
<li><a class="reference internal" href="#the-model">The model</a><ul>
<li><a class="reference internal" href="#the-view">The View</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gorm-installation">Gorm Installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-the-graphic-interfaces">Creating the graphic interfaces</a></li>
<li><a class="reference internal" href="#connecting-the-view-and-the-controller">Connecting the View and the Controller</a><ul>
<li><a class="reference internal" href="#keyboard-navigation">Keyboard Navigation</a></li>
<li><a class="reference internal" href="#code-of-the-controller">Code of the Controller</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-main-function-of-our-programme">The main function of our programme</a></li>
<li><a class="reference internal" href="#the-makefiles">The Makefiles</a></li>
<li><a class="reference internal" href="#archiving-an-object">Archiving an object</a></li>
<li><a class="reference internal" href="#modification-of-todocontroller">Modification of TodoController</a></li>
<li><a class="reference internal" href="#modification-of-the-gorm-file">Modification of the gorm file</a></li>
<li><a class="reference internal" href="#credits">Credits</a></li>
<li><a class="reference internal" href="#links">Links</a><ul>
<li><a class="reference internal" href="#footnotes">Footnotes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=172f29ee"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    </body>
</html>